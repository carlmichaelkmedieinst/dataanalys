<!doctype html>
<html lang="sv">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K23LPS3V');</script>
<!-- End Google Tag Manager -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rekommenderad Marketing Automation-setup</title>
  <meta name="description" content="Praktisk Marketing Automation-setup baserad på ditt quiz-resultat." />
  <link rel="stylesheet" href="style.css" />
  <script>window.dataLayer = window.dataLayer || [];</script>
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K23LPS3V"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<main class="wrap">

  <header class="header">
    <div class="badge">Rekommendation</div>
    <h1>Din rekommenderade setup</h1>
    <p class="sub" id="subtitle">Baserat på ditt quiz-resultat</p>
  </header>

  <section class="card">
    <div class="screen">

      <!-- OVERVIEW -->
      <section class="section" id="overview">
        <div class="result">
          <div id="stack-badge" class="result__badge">Stack</div>
          <h2 id="stack-title" class="result__title">—</h2>
          <p id="stack-summary" class="result__summary">—</p>

          <div class="section__grid">
            <div class="metric">
              <div class="metric__label">Målbild</div>
              <div id="goal" class="metric__value">—</div>
              <div id="goal-note" class="metric__note">—</div>
            </div>
            <div class="metric">
              <div class="metric__label">Risk om du överbygger</div>
              <div id="risk" class="metric__value">—</div>
              <div id="risk-note" class="metric__note">—</div>
            </div>
            <div class="metric">
              <div class="metric__label">Vad du bör fokusera på nu</div>
              <div id="next" class="metric__value">—</div>
              <div id="next-note" class="metric__note">—</div>
            </div>
          </div>
        </div>
      </section>

      <!-- IMPLEMENTATION PLAN -->
      <section class="section" id="plan">
        <h3 class="section__title">Nästa 7 dagar: så kommer du igång</h3>
        <p class="section__sub">
          En praktisk handlingsplan för att implementera rekommendationen i din organisation.
        </p>
        <ol id="plan-steps" class="steps"></ol>
      </section>

      <!-- MODULES -->
      <section class="section" id="modules">
        <h3 class="section__title">Rekommenderade byggblock</h3>
        <p class="section__sub">
          Bygg dessa i ordning. Varje block är valt för att ge effekt utan att skapa systemskuld.
        </p>
        <div id="module-list" class="accordion"></div>
      </section>

      <!-- TOOLS -->
      <section class="section" id="tools">
        <h3 class="section__title">Verktyg som passar din situation</h3>
        <p class="section__sub">
          Exempel på verktyg som matchar rekommendationen. Klick till verktyg är en tydlig proxy för intent.
        </p>
        <div id="tool-links" class="tools"></div>
      </section>

      <div class="cta-row">
        <a class="btn ghost" href="index.html" id="back-to-quiz">Gör quizet igen</a>
      </div>

    </div>
  </section>

</main>

<script>
/* --------------------------------------------------
   dataLayer helper
-------------------------------------------------- */
window.dataLayer = window.dataLayer || [];

const dlPush = (event, params = {}) => {
  window.dataLayer.push({
    event,
    ...params,
    page_path: location.pathname,
    page_title: document.title,
    ts: Date.now()
  });
};

const $ = (sel) => document.querySelector(sel);

/* --------------------------------------------------
   Stack content (EXTERNAL implementation plans)
   - tools are real links (outbound tracking)
-------------------------------------------------- */
const STACK_CONTENT = {
  starter: {
    badge: "Starter",
    title: "Starter stack",
    summary: "En enkel men stabil grund för Marketing Automation utan att bygga onödig komplexitet.",
    goal: ["Kom igång snabbt", "Bygg något som går att skala senare"],
    risk: ["För många verktyg för tidigt", "Automation utan tydligt mål"],
    next: ["Få grundläggande struktur", "Börja mäta rätt beteenden"],
    plan: [
      { day: "Dag 1", do: "Definiera vad som räknas som en lead eller konvertering för er.", outcome: "Ni mäter rätt sak." },
      { day: "Dag 2", do: "Sätt 2–4 enkla segment baserat på behov eller intent.", outcome: "Ni kan anpassa budskap utan komplexitet." },
      { day: "Dag 3", do: "Bygg ett enkelt nurture-flöde (värde → case → CTA).", outcome: "Automation som faktiskt driver handling." },
      { day: "Dag 4", do: "Standardisera formulär och definiera uppföljning.", outcome: "Intent blir spårbart." },
      { day: "Dag 5", do: "Sätt en enkel funnel-dashboard.", outcome: "Ni ser vad som funkar." },
      { day: "Dag 6", do: "Förbättra en sak baserat på data.", outcome: "Ni börjar arbeta iterativt." },
      { day: "Dag 7", do: "Dokumentera flöden, segment och ansvar.", outcome: "Ni kan skala utan kaos." }
    ],
    modules: [
      { title: "Enkel MA-plattform", text: "E-post, segment och grundläggande automation." },
      { title: "Spårning & mätning", text: "Event-baserad mätning av intent och konvertering." },
      { title: "Formulär & consent", text: "Tydlig struktur för leads och GDPR." }
    ],
    tools: [
      { id: "activecampaign", label: "ActiveCampaign", href: "https://www.activecampaign.com/" },
      { id: "hubspot", label: "HubSpot", href: "https://www.hubspot.com/" },
      { id: "ga4", label: "Google Analytics (GA4)", href: "https://analytics.google.com/" },
      { id: "gtm", label: "Google Tag Manager", href: "https://tagmanager.google.com/" },
      { id: "looker_studio", label: "Looker Studio", href: "https://lookerstudio.google.com/" }
    ]
  },

  growth_hubspot: {
    badge: "Growth",
    title: "Growth stack (HubSpot)",
    summary: "En sammanhållen setup där CRM och Marketing Automation arbetar som ett system.",
    goal: ["Skapa struktur", "Synka marknad och sälj"],
    risk: ["Implementera utan governance", "Bli kampanjdriven"],
    next: ["Lifecycle-struktur", "Lead scoring + nurture"],
    plan: [
      { day: "Dag 1", do: "Definiera lifecycle-steg och kriterier.", outcome: "Gemensamt språk." },
      { day: "Dag 2", do: "Städa CRM-minimum (fält, ägarskap, dubbletter).", outcome: "Stabil databas." },
      { day: "Dag 3", do: "Inför lead scoring (minimalt).", outcome: "Prioriterade leads." },
      { day: "Dag 4", do: "Bygg två nurture-spår (utbildande + köpnära).", outcome: "Systematisk rörelse mot affär." },
      { day: "Dag 5", do: "Definiera SLA mellan marknad och sälj.", outcome: "Tydligt ansvar." },
      { day: "Dag 6", do: "Sätt pipeline-översikt (MQL→SQL→Won).", outcome: "Synlig affärseffekt." },
      { day: "Dag 7", do: "Inför veckovis QA-rutin (flows, consent, leveransbarhet).", outcome: "Systemet håller över tid." }
    ],
    modules: [
      { title: "CRM som källa till sanning", text: "Lifecycle, ägarskap och struktur." },
      { title: "Nurturing & scoring", text: "Flytta leads systematiskt och prioritera." },
      { title: "Ops-rutiner", text: "QA, consent, leveransbarhet." }
    ],
    tools: [
      { id: "hubspot", label: "HubSpot", href: "https://www.hubspot.com/" },
      { id: "ga4", label: "Google Analytics (GA4)", href: "https://analytics.google.com/" },
      { id: "gtm", label: "Google Tag Manager", href: "https://tagmanager.google.com/" },
      { id: "looker_studio", label: "Looker Studio", href: "https://lookerstudio.google.com/" }
    ]
  },

  scale_revops: {
    badge: "Scale",
    title: "Scale stack (RevOps)",
    summary: "För organisationer som behöver orkestrera marknad och sälj över flera system.",
    goal: ["Skala kontrollerat", "Mät pipeline-påverkan"],
    risk: ["Integrationskaos", "Otydligt ägarskap"],
    next: ["Data contracts + governance", "SLA + pipeline-rapportering"],
    plan: [
      { day: "Dag 1", do: "Kartlägg system och ägarskap (CRM, MA, webb, support/billing, BI).", outcome: "Klar ansvarsfördelning." },
      { day: "Dag 2", do: "Definiera data- och integrationsregler (fält, riktning, naming).", outcome: "Mindre kaos." },
      { day: "Dag 3", do: "Sätt monitorering på integrationer (fel, latency, retries).", outcome: "Problem syns direkt." },
      { day: "Dag 4", do: "Bygg SLA-logik för sälj (time-to-first-touch).", outcome: "Styr beteende med data." },
      { day: "Dag 5", do: "Segment-baserad scoring (inte one-size-fits-all).", outcome: "Bättre prioritering." },
      { day: "Dag 6", do: "Pipeline-dashboards (velocity, stage drop-off).", outcome: "Datadrivna beslut." },
      { day: "Dag 7", do: "Etablera insight → action-loop (1 insikt → 1 ändring → mätning).", outcome: "Kontinuerlig förbättring." }
    ],
    modules: [
      { title: "Governance", text: "Ägarskap och standarder för data och process." },
      { title: "Integrationer", text: "Styrda och övervakade flöden mellan system." },
      { title: "BI & rapportering", text: "Pipeline och velocity som styr beslut." }
    ],
    tools: [
      { id: "hubspot", label: "HubSpot", href: "https://www.hubspot.com/" },
      { id: "salesforce", label: "Salesforce", href: "https://www.salesforce.com/" },
      { id: "ga4", label: "Google Analytics (GA4)", href: "https://analytics.google.com/" },
      { id: "gtm", label: "Google Tag Manager", href: "https://tagmanager.google.com/" },
      { id: "looker_studio", label: "Looker Studio", href: "https://lookerstudio.google.com/" }
    ]
  },

  enterprise_light: {
    badge: "Enterprise-light",
    title: "Enterprise-light stack",
    summary: "För hög komplexitet och många system. Här vinner du på arkitektur, governance och compliance före “fler kampanjer”.",
    goal: ["Styrbar arkitektur", "Datakvalitet + compliance först"],
    risk: ["Lång implementation", "Datadrift och incidenter utan owners"],
    next: ["Systeminventering + governance", "Stabil identitet/consent + integrationsdisciplin"],
    plan: [
      { day: "Dag 1", do: "Inventera system: källor, master data, identity, consent-flöden.", outcome: "Ni vet vad som är möjligt och var riskerna finns." },
      { day: "Dag 2", do: "Definiera governance: data owners, change process, standarder (fält/naming).", outcome: "Ni får kontroll när många team är inblandade." },
      { day: "Dag 3", do: "Designa integrationsprinciper: sync-riktning, felhantering, monitorering.", outcome: "Systemet blir driftbart." },
      { day: "Dag 4", do: "Definiera compliance: retention, rättigheter, loggning, audit-spår.", outcome: "Ni kan skala utan GDPR-smäll." },
      { day: "Dag 5", do: "Sätt core event-modell + datamodell (minimalt men stabilt).", outcome: "Gemensam mätbarhet över system." },
      { day: "Dag 6", do: "Bygg BI core dashboards (pipeline + adoption + datakvalitet).", outcome: "Ni styr med signal, inte magkänsla." },
      { day: "Dag 7", do: "Etablera drift/QA-rutin: monitorering, incidentprocess, ansvar per område.", outcome: "Ni stoppar datakvalitet från att erodera." }
    ],
    modules: [
      { title: "Arkitektur & master data", text: "Definiera källor, identitet och principer." },
      { title: "Integrationer + monitorering", text: "Spårbarhet, felhantering, driftbarhet." },
      { title: "Compliance", text: "Consent, retention, audit." }
    ],
    tools: [
      { id: "salesforce", label: "Salesforce", href: "https://www.salesforce.com/" },
      { id: "marketing_cloud", label: "Salesforce Marketing Cloud", href: "https://www.salesforce.com/products/marketing-cloud/overview/" },
      { id: "account_engagement", label: "Salesforce Account Engagement (Pardot)", href: "https://www.salesforce.com/products/marketing-cloud/account-engagement/" },
      { id: "ga4", label: "Google Analytics (GA4)", href: "https://analytics.google.com/" },
      { id: "gtm", label: "Google Tag Manager", href: "https://tagmanager.google.com/" }
    ]
  }
};

/* --------------------------------------------------
   Render
-------------------------------------------------- */
const params = new URLSearchParams(location.search);
const stackKey = params.get("stack") || localStorage.getItem("ma_quiz_last_result") || "starter";
const c = STACK_CONTENT[stackKey] || STACK_CONTENT.starter;

$("#subtitle").textContent = `Baserat på ditt quiz-resultat: ${c.title}`;

$("#stack-badge").textContent = c.badge;
$("#stack-title").textContent = c.title;
$("#stack-summary").textContent = c.summary;

$("#goal").textContent = c.goal[0];
$("#goal-note").textContent = c.goal[1];

$("#risk").textContent = c.risk[0];
$("#risk-note").textContent = c.risk[1];

$("#next").textContent = c.next[0];
$("#next-note").textContent = c.next[1];

// Plan
const planEl = $("#plan-steps");
planEl.innerHTML = "";
c.plan.forEach((p) => {
  const li = document.createElement("li");
  li.className = "steps__item";
  li.innerHTML = `
    <div class="steps__day">${p.day}</div>
    <div class="steps__do">${p.do}</div>
    <div class="steps__outcome">${p.outcome}</div>
  `;
  planEl.appendChild(li);
});

// Modules
const moduleEl = $("#module-list");
moduleEl.innerHTML = "";
c.modules.forEach((m) => {
  const div = document.createElement("div");
  div.className = "accordion__item";
  div.innerHTML = `<div style="padding:12px;"><strong>${m.title}</strong><p class="fine" style="margin:6px 0 0;">${m.text}</p></div>`;
  moduleEl.appendChild(div);
});

// Tools (real links + outbound tracking)
const toolEl = $("#tool-links");
toolEl.innerHTML = "";
c.tools.forEach((t, idx) => {
  const a = document.createElement("a");
  a.className = "tool";
  a.href = t.href;
  a.target = "_blank";
  a.rel = "noopener noreferrer";
  a.innerHTML = `<div class="tool__label">${t.label}</div><div class="tool__meta">Öppnas i ny flik</div>`;
  a.addEventListener("click", () => {
    dlPush("ma_setup_outbound_click", {
      stack: stackKey,
      outbound_id: t.id,
      outbound_index: idx + 1
    });
  });
  toolEl.appendChild(a);
});

// Tracking: setup view
dlPush("ma_setup_view", { stack: stackKey });

/* --------------------------------------------------
   Scroll depth tracking (25/50/75/90) - once each
-------------------------------------------------- */
(function trackScrollDepth() {
  const marks = [25, 50, 75, 90];
  const fired = new Set();

  window.addEventListener("scroll", () => {
    const doc = document.documentElement;
    const max = doc.scrollHeight - doc.clientHeight;
    if (max <= 0) return;

    const percent = Math.round((window.scrollY / max) * 100);
    for (const m of marks) {
      if (!fired.has(m) && percent >= m) {
        fired.add(m);
        dlPush("ma_setup_scroll_depth", { stack: stackKey, percent: m });
      }
    }
  }, { passive: true });
})();

/* --------------------------------------------------
   Section view tracking (plan/modules/tools) - once each
   More precise than scroll % for "did they reach the last recommendations?"
-------------------------------------------------- */
(function trackSectionViews() {
  const sectionIds = ["plan", "modules", "tools"];
  const seen = new Set();

  if (!("IntersectionObserver" in window)) {
    // Fallback: if browser doesn't support, do nothing (avoid noisy approximations)
    return;
  }

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting && !seen.has(entry.target.id)) {
          seen.add(entry.target.id);
          dlPush("ma_setup_section_view", {
            stack: stackKey,
            section_id: entry.target.id
          });
        }
      });
    },
    { threshold: 0.4 }
  );

  sectionIds.forEach((id) => {
    const el = document.getElementById(id);
    if (el) observer.observe(el);
  });
})();
</script>

</body>
</html>
